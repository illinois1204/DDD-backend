# О сути
#### Архитектура приложения построена на следующей предметной области (выдумана мной, просто чтобы отразить какую-нибудь действительность):

#### Имеется некая ферма (территория), она делиться на сектора, на каждом секторе может быть n-ое кол-во сенсоров. Каждый сенсор с определенной частотой отправляет данные о показателях почвы и все это записывается в БД.

#### Таким образом выделяется 3 сущности: sector, sensor, sensor-data.
```
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+                  +                      +                     +
+                  +                      +              ●      +
+     ●     ●      +       ●              +                     +
+                  +                      +                     +
+   ●              +              ●       +                     +
+           ●      +                      +     ●               +
+                  +                      +                     +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+                  +                      +                     +
+                  +                      +                     +
+                  +                      +          ●          +
+                  +          ●           +                     +
+                  +                      +                     +
+      ●           +                      +    ●             ●  +
+                  +                   ●  +                     +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+                  +                      +                     +
+       ●          +               ●      +    ●                +
+                  +                      +               ●     +
+        ●         +                      +                     +
+                  +                      +                     +
+            ●     +    ●                 +    ●          ●     +
+                  +                      +                     +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
```

# О приложении
Приложение состоит из 4 основных разделов:
```
●
|__app (транспортный слой со своими правилами обработки и валидации:
|       http, grpc, pub-sub, brokers)
|
|__cmd (раннеры запуска)
|
|__external (некомпилируемые ресурсы swagger, templates, proto)
|
|__internal ●
            |
            |__common (интерфейсы, хендлеры, типы, энумы)
            |
            |__db (драйверы подключения)
            |
            |__domain (описание сущностей и работа с репозиториями)
            |
            |__services (различные инструменты s3, jwt, mailer)

```
## Команды для запуска и работы с проектом

#### создать миграцию:
```
npx knex migrate:make _name_ -x ts --migrations-directory ./internal/db/sql/migrations
```

#### скрипты управления:
```
"lint": линт всего проекта
"build": билд проекта
"start": запуск билда
"start:dry": запуск билда на локальной машине (для теста)
"local": запуск при локальной разработке
"migrate:sql:up": запуск миграции
"migrate:sql:up:local": запуск миграции на локальной машине
```

# Прочее
#### Для использования Redis stream (в качестве брокера) необходимо сперва создать стрим и группу и зафиксировать имя потребителя в окружении приложения. В случае скейлинга имена потребителей должны быть разными на каждой реплике!